import{z as e}from"./DnjKlDmc.js";import{_ as a}from"./B1lyFI3-.js";import{f as t,q as s,a0 as r,r as n,N as o,u as p,o as l,b as u,d,p as h,t as i,n as c,a as m,G as v,a1 as b,l as w,a2 as _,s as y,J as N,j as C}from"./DGIvrB3b.js";const g={class:"container"},k={class:"inner-container"},U={class:"btns"},f=["disabled"],q=t({__name:"phone",setup(t){const q=s(),E=r().$i18n.t,G=n(""),P=n(null),j=n(!1),x=n("idle"),I=o(),V=p(),O=I.options.history.state.showPaywall,D=e=>{j.value=e.valid,e.valid&&(P.value=e.number)},S=async()=>{x.value="loading";try{const e=(await b({path:"/user/phone",method:"POST",data:{userId:V.user.uid,phoneNumber:P.value}})).data;e.success?(w({ph:await _(P.value.split("+")[1])}),V.editUserData({phoneNumber:P.value}),y({eventName:"added_phone_number",eventGroup:"phone"}),O?(y({eventName:"should_open_paywall",properties:{source:"whatsapp"}}),N({pah:q("/payment"),state:{source:"whatsapp"}})):N({path:q("/chat")})):"whatsapp_already_subscribed"==e.errorCode?(y({eventName:"whatsapp_auth_required",eventGroup:"phone"}),alert(e.error),N({path:q("/whatsapp"),query:{phone:P.value}})):alert(E("errorUnexpectedError"))}catch(e){e&&e.response&&e.response.data&&"whatsapp_already_subscribed"==e.response.data.errorCode?(y({eventName:"whatsapp_auth_required",eventGroup:"phone"}),alert(e.response.data.error),N({path:q("/whatsapp"),query:{phone:P.value}})):(console.log(e),alert(E("errorUnexpectedError")))}},z=async()=>{x.value="loading";try{await C({userId:V.user.uid,skippedPhoneNumber:!0}),V.editUserData({skippedPhoneNumber:!0}),y({eventName:"skipped_phone_number",eventGroup:"phone"}),O?(y({eventName:"should_open_paywall",properties:{source:"whatsapp"}}),N({path:q("/payment"),state:{source:"whatsapp"}})):N({path:q("/chat")})}catch(e){alert(E("errorUnexpectedError")),console.log(e)}};return(t,s)=>{const r=e;return l(),u("div",g,[d("div",k,[d("h1",null,[s[1]||(s[1]=d("img",{src:a,class:"whatsapp-icon",alt:"whatsapp icon"},null,-1)),h(" "+i(c(E)("phoneCollectWhatsappConnect")),1)]),d("p",null,i(c(E)("phoneCollectPhoneNumber")),1),m(r,{styleClasses:"tel-input-wrapper",inputOptions:{styleClasses:"tel-input",placeholder:"Enter your phone number",type:"tel"},modelValue:c(G),"onUpdate:modelValue":s[0]||(s[0]=e=>v(G)?G.value=e:null),validCharactersOnly:!0,mode:"international",invalidMsg:"Invalid phone number",onValidate:D,placeholder:"Enter your phone number"},null,8,["modelValue"]),d("div",U,[d("button",{class:"btn btn-success",onClick:S,disabled:!c(j)||"idle"!=c(x)},i(c(E)("buttonContinue")),9,f),d("button",{class:"btn",onClick:z},i(c(E)("phoneCollectSkipForNow")),1)])])])}}},[["__scopeId","data-v-e7a38c06"]]);export{q as default};
